# Excel テキスト置換ツール (v4.8) ユーザーマニュアル

このツールは、指定したフォルダ内のExcelファイル（.xlsx, .xlsm）を一括検索・置換するためのアプリケーションです。

## 特徴
*   **高速検索・置換**: 多数のExcelファイルをまとめて処理できます。
*   **Web UI搭載**: ブラウザ上で直感的に操作できます。
*   **レポート出力**: 検索・置換の結果をCSVまたはTSVファイルとして出力します。
*   **安全設計**: 置換モードでは、変更箇所が青色・太字で強調保存されます。
*   **長いパス対応**: Windowsの深い階層にあるファイルも問題なく処理できます。

## インストール方法
特別なインストールは不要です。配布された `excel_converter_v4.8.exe` を任意のフォルダに配置してください。

## 使い方

### 1. アプリの起動
`excel_converter_v4.8.exe` をダブルクリックして実行します。
黒い画面（コンソール）が立ち上がり、自動的にブラウザが開いて操作画面が表示されます。

※ ブラウザが自動で開かない場合は、ブラウザのアドレスバーに `http://localhost:8080` と入力してください。

### 2. 画面操作
1.  **モード選択**:
    *   **検索のみ**: 文字列の検索のみ行います。ファイルは変更されません。
    *   **置換実行**: 文字列を置換し、ファイルを上書き保存します。
2.  **対象ディレクトリ**:
    *   「参照...」ボタンを押して、処理したいExcelファイルが入っているフォルダを選択してください。
3.  **除外設定 (任意)**:
    *   処理したくない拡張子（.xlsx, .xlsm）や、除外したいサブフォルダを指定できます。
4.  **検索文字列**:
    *   検索したい文字を入力してください（必須）。
5.  **置換後の文字列**:
    *   「置換実行」モードの場合のみ入力します。
6.  **出力形式**:
    *   **CSV**: カンマ区切りのレポートを出力します（デフォルト）。
    *   **TSV**: タブ区切りのレポートを出力します。
7.  **処理開始**:
    *   「処理開始」ボタンを押すと実行されます。進捗バーが表示されます。

### 3. 結果の確認
処理が完了すると、結果の統計（処理ファイル数、ヒット数など）が表示されます。
「レポートをダウンロード」ボタンを押すと、詳細な結果（CSVまたはTSVファイル）をダウンロードできます。

**レポートの内容**:
*   File Path: ファイルの場所
*   Sheet: シート名
*   Cell: セル番地 (例: A1)
*   Old Value: 置換前の値
*   New Value: 置換後の値
*   Status: 処理結果 (Success, Found, Failed)
*   Message: エラーメッセージなど

## 注意事項
> [!WARNING]
> **Excelの強制終了について**
> 処理開始時に、開いているExcelファイルへの干渉を防ぐため、**実行中のExcelプロセスを強制終了**します。
> 編集中のExcelファイルがある場合は、必ず保存して閉じてから本ツールを実行してください。

> [!IMPORTANT]
> **バックアップの推奨**
> 「置換実行」モードはファイルを上書き保存します。念のため、重要なデータは事前にバックアップ（コピー）を取ってから実行することを強く推奨します。

## トラブルシューティング

### Q. 「サーバー停止」ボタンを押しても画面が消えない
A. ブラウザのタブは自動では閉じません。手動で閉じてください。

### Q. エラー「Save failed...」が出る
A. ファイルが読み取り専用になっていないか、または他のユーザーが開いていないか確認してください。本ツールは保存に失敗した場合でも、その内容をレポートの「Status: Failed」として記録します。

### Q. 起動しない（一瞬で閉じる）
A. すでにポート8080を使用している別のアプリがある可能性があります。PCを再起動するか、コマンドプロンプトから `excel_converter_v4.8.exe -port 8081` のように別のポートを指定して起動してみてください。
